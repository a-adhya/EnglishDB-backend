*************************TESTS****************************


Question: How many customers are represented in this database?

Response: SELECT COUNT(*) 
FROM customers 

Database Query Result: [(59,)]
Question: What was the name of the longest song in this database?

Response: SELECT tracks.Name AS LongestSongName
FROM tracks
ORDER BY Milliseconds DESC
LIMIT 1 

Database Query Result: [('Occupation / Precipice',)]
Question: For each genre, name the state in the US that the genre was most popular in.

Response: Error: Sorry I cannot help you with that request. Would you like to learn more about the database? 

Database Query Result: Error: Sorry I cannot help you with that request. Would you like to learn more about the database?
Question: What is the most data-heavy track in this database?

Response: SELECT 
    [Name], MAX([Bytes]) AS MostDataHeavy
FROM 
    tracks 

Database Query Result: [('Through a Looking Glass', 1059546140)]
Question: What are the total dollar sales for each album?

Response: SELECT albums.AlbumId, albums.Title, SUM(invoice_items.Quantity * invoice_items.UnitPrice) AS TotalSales
FROM albums
JOIN tracks ON albums.AlbumId = tracks.AlbumId
JOIN invoice_items ON tracks.TrackId = invoice_items.TrackId
GROUP BY albums.AlbumId, albums.Title
ORDER BY TotalSales DESC 

Database Query Result: [(253, 'Battlestar Galactica (Classic), Season 1', 35.82), (251, 'The Office, Season 3', 31.84), (23, 'Minha Historia', 26.73), (228, 'Heroes, Season 1', 25.87), (231, 'Lost, Season 2', 25.87), (141, 'Greatest Hits', 25.74), (73, 'Unplugged', 24.75), (227, 'Battlestar Galactica, Season 3', 23.88), (229, 'Lost, Season 3', 21.89), (224, 'Acústico', 21.78), (230, 'Lost, Season 1', 19.9), (37, 'Greatest Kiss', 19.8), (21, 'Prenda Minha', 18.81), (55, 'Chronicle, Vol. 2', 18.81), (221, 'My Generation - The Very Best Of The Who', 18.81), (39, 'International Superhits', 17.82), (54, 'Chronicle, Vol. 1', 17.82), (167, 'Acústico MTV', 17.82), (51, "Up An' Atom", 16.83), (91, 'Use Your Illusion I', 16.83), (190, 'The Best Of R.E.M.: The IRS Years', 16.83), (237, 'Rattle And Hum', 16.83), (24, 'Afrociberdelia', 15.84), (255, 'Instant Karma: The Amnesty International Campaign to Save Darfur', 15.84), (34, 'Chill: Brazil (Disc 2)', 14.85), (52, 'Vinícius De Moraes - Sem Limite', 14.85), (72, 'The Cream Of Clapton', 14.85), (89, 'American Idiot', 14.85), (169, 'Arquivo Os Paralamas Do Sucesso', 14.85), (203, 'A-Sides', 14.85), (261, 'LOST, Season 4', 13.93), (36, 'Greatest Hits II', 13.86), (189, 'New Adventures In Hi-Fi', 13.86), (71, 'Elis Regina-Minha História', 12.87), (74, 'Album Of The Year', 12.87), (75, 'Angel Dust', 12.87), (86, 'Quanta Gente Veio Ver (Live)', 12.87), (165, 'Compositores', 12.87), (202, 'Rotten Apples: Greatest Hits', 12.87), (250, 'The Office, Season 2', 11.94), (19, 'Chemical Wedding', 11.879999999999999), (56, 'Cássia Eller - Coleção Sem Limite [Disc 2]', 11.879999999999999), (115, 'Sex Machine', 11.879999999999999), (149, 'Garage Inc. (Disc 2)', 11.879999999999999), (153, 'ReLoad', 11.879999999999999), (168, 'Arquivo II', 11.879999999999999), (186, 'News Of The World', 11.879999999999999), (207, 'Mezmerize', 11.879999999999999), (222, 'Serie Sem Limite (Disc 1)', 11.879999999999999), (223, 'Serie Sem Limite (Disc 2)', 11.879999999999999), (225, 'Volume Dois', 11.879999999999999), (321, 'Back to Black', 11.879999999999999), (18, 'Body Count', 10.89), (38, 'Heart of the Night', 10.89), (53, 'Vozes do MPB', 10.89), (113, 'The X Factor', 10.89), (126, 'Unplugged [Live]', 10.89), (150, "Kill 'Em All", 10.89), (151, 'Load', 10.89), (185, 'Greatest Hits I', 10.89), (201, 'Judas 0: B-Sides and Rarities', 10.89), (234, 'B-Sides 1980-1990', 10.89), (238, 'The Best Of 1980-1990', 10.89), (239, 'War', 10.89), (1, 'For Those About To Rock We Salute You', 9.9), (5, 'Big Ones', 9.9), (83, 'My Way: The Best Of Frank Sinatra [Disc 1]', 9.9), (92, 'Use Your Illusion II', 9.9), (125, 'Living After Midnight', 9.9), (127, 'BBC Sessions [Disc 2] [Live]', 9.9), (146, 'Seek And Shall Find: More Of The Best (1963-1981)', 9.9), (152, 'Master Of Puppets', 9.9), (166, 'Olodum', 9.9), (174, 'Tribute', 9.9), (192, 'Raul Seixas', 9.9), (193, 'Blood Sugar Sex Magik', 9.9), (206, 'Core', 9.9), (211, 'The Singles', 9.9), (219, 'Tangents', 9.9), (235, 'How To Dismantle An Atomic Bomb', 9.9), (236, 'Pop', 9.9), (243, 'The Best Of Van Halen, Vol. I', 9.9), (25, 'Da Lama Ao Caos', 8.91), (26, 'Acústico MTV [Live]', 8.91), (41, 'Meus Momentos', 8.91), (57, 'Cássia Eller - Sem Limite [Disc 1]', 8.91), (69, 'Djavan Ao Vivo - Vol. 02', 8.91), (70, 'Djavan Ao Vivo - Vol. 1', 8.91), (76, 'King For A Day Fool For A Lifetime', 8.91), (90, 'Appetite for Destruction', 8.91), (93, 'Blue Moods', 8.91), (107, 'Powerslave', 8.91), (110, 'Seventh Son of a Seventh Son', 8.91), (112, 'The Number of The Beast', 8.91), (132, 'Led Zeppelin I', 8.91), (133, 'Led Zeppelin II', 8.91), (134, 'Led Zeppelin III', 8.91), (139, 'A TempestadeTempestade Ou O Livro Dos Dias', 8.91), (148, 'Black Album', 8.91), (176, 'Original Soundtracks 1', 8.91), (178, 'Live On Two Legs [Live]', 8.91), (184, 'Os Cães Ladram Mas A Caravana Não Pára', 8.91), (187, 'Out Of Time', 8.91), (195, 'Californication', 8.91), (204, 'Morning Dance', 8.91), (205, 'In Step', 8.91), (213, 'Pure Cult: The Best Of The Cult (For Rockers, Ravers, Lovers & Sinners) [UK]', 8.91), (240, 'Zooropa', 8.91), (248, 'Ao Vivo [IMPORT]', 8.91), (6, 'Jagged Little Pill', 7.92), (40, 'Into The Light', 7.92), (42, 'Minha História', 7.92), (78, 'Deixa Entrar', 7.92), (84, 'Roda De Funk', 7.92), (88, 'Faceless', 7.92), (102, 'Live After Death', 7.92), (105, 'No Prayer For The Dying', 7.92), (108, 'Rock In Rio [CD1]', 7.92), (109, 'Rock In Rio [CD2]', 7.92), (120, 'Are You Experienced?', 7.92), (130, 'In Through The Out Door', 7.92), (140, 'Mais Do Mesmo', 7.92), (142, 'Lulu Santos - RCA 100 Anos De Música - Álbum 01', 7.92), (145, 'Barulhinho Bom', 7.92), (147, 'The Best Of Men At Work', 7.92), (158, 'Milton Nascimento Ao Vivo', 7.92), (175, 'Walking Into Clarksdale', 7.92), (188, 'Green', 7.92), (194, 'By The Way', 7.92), (241, 'UB40 The Best Of - Volume Two [UK]', 7.92), (258, 'House of Pain', 7.92), (7, 'Facelift', 6.93), (8, 'Warner 25 Anos', 6.93), (17, 'Black Sabbath Vol. 4 (Remaster)', 6.93), (20, 'The Best Of Buddy Guy - The Millenium Collection', 6.93), (27, 'Cidade Negra - Hits', 6.93), (33, 'Chill: Brazil (Disc 1)', 6.93), (35, 'Garage Inc. (Disc 1)', 6.93), (67, "Vault: Def Leppard's Greatest Hits", 6.93), (77, 'The Real Thing', 6.93), (95, 'A Real Dead One', 6.93), (114, 'Virtual XI', 6.93), (117, 'Synkronized', 6.93), (119, 'Get Born', 6.93), (129, 'Houses Of The Holy', 6.93), (155, 'St. Anger', 6.93), (157, 'Miles Ahead', 6.93), (159, 'Minas', 6.93), (162, 'Motley Crue Greatest Hits', 6.93), (163, 'From The Muddy Banks Of The Wishkah [Live]', 6.93), (180, 'Riot Act', 6.93), (191, 'Cesta Básica', 6.93), (209, 'Live [Disc 1]', 6.93), (210, 'Live [Disc 2]', 6.93), (212, 'Beyond Good And Evil', 6.93), (215, 'The Police Greatest Hits', 6.93), (218, 'Voodoo Lounge', 6.93), (220, 'Transmission', 6.93), (242, 'Diver Down', 6.93), (256, 'Speak of the Devil', 6.93), (259, 'Radio Brasil (O Som da Jovem Vanguarda) - Seleccao de Henrique Amaro', 6.93), (249, 'The Office, Season 1', 5.97), (4, 'Let There Be Rock', 5.9399999999999995), (10, 'Audioslave', 5.9399999999999995), (12, 'BackBeat Soundtrack', 5.9399999999999995), (29, 'Axé Bahia 2001', 5.9399999999999995), (30, 'BBC Sessions [Disc 1] [Live]', 5.9399999999999995), (32, 'Carnaval 2001', 5.9399999999999995), (45, 'Sambas De Enredo 2001', 5.9399999999999995), (46, 'Supernatural', 5.9399999999999995), (47, 'The Best of Ed Motta', 5.9399999999999995), (48, 'The Essential Miles Davis [Disc 1]', 5.9399999999999995), (80, 'In Your Honor [Disc 2]', 5.9399999999999995), (82, 'The Colour And The Shape', 5.9399999999999995), (94, 'A Matter of Life and Death', 5.9399999999999995), (97, 'Brave New World', 5.9399999999999995), (104, 'Live At Donington 1992 (Disc 2)', 5.9399999999999995), (116, 'Emergency On Planet Earth', 5.9399999999999995), (122, 'Jorge Ben Jor 25 Anos', 5.9399999999999995), (123, 'Jota Quest-1995', 5.9399999999999995), (124, 'Cafezinho', 5.9399999999999995), (128, 'Coda', 5.9399999999999995), (131, 'IV', 5.9399999999999995), (154, 'Ride The Lightning', 5.9399999999999995), (156, '...And Justice For All', 5.9399999999999995), (160, 'Ace Of Spades', 5.9399999999999995), (161, 'Demorou...', 5.9399999999999995), (179, 'Pearl Jam', 5.9399999999999995), (182, 'Vs.', 5.9399999999999995), (196, 'Retrospective I (1974-1980)', 5.9399999999999995), (199, 'Maquinarama', 5.9399999999999995), (217, 'No Security', 5.9399999999999995), (232, 'Achtung Baby', 5.9399999999999995), (233, "All That You Can't Leave Behind", 5.9399999999999995), (244, 'Van Halen', 5.9399999999999995), (245, 'Van Halen III', 5.9399999999999995), (246, 'Contraband', 5.9399999999999995), (247, 'Vinicius De Moraes', 5.9399999999999995), (322, 'Frank', 5.9399999999999995), (11, 'Out Of Exile', 4.95), (14, 'Alcohol Fueled Brewtality Live! [Disc 1]', 4.95), (28, 'Na Pista', 4.95), (58, 'Come Taste The Band', 4.95), (61, "Knocking at Your Back Door: The Best Of Deep Purple in the 80's", 4.95), (63, 'Purpendicular', 4.95), (66, 'The Battle Rages On', 4.95), (79, 'In Your Honor [Disc 1]', 4.95), (81, 'One By One', 4.95), (85, 'As Canções de Eu Tu Eles', 4.95), (96, 'A Real Live One', 4.95), (98, 'Dance Of Death', 4.95), (99, 'Fear Of The Dark', 4.95), (101, 'Killers', 4.95), (106, 'Piece Of Mind', 4.95), (111, 'Somewhere in Time', 4.95), (118, 'The Return Of The Space Cowboy', 4.95), (135, 'Physical Graffiti [Disc 2]', 4.95), (136, 'Presence', 4.95), (143, 'Lulu Santos - RCA 100 Anos De Música - Álbum 02', 4.95), (144, 'Misplaced Childhood', 4.95), (164, 'Nevermind', 4.95), (177, 'The Beast Live', 4.95), (208, '[1997] Black Light Syndrome', 4.95), (216, 'Hot Rocks, 1964-1971 (Disc 1)', 4.95), (257, '20th Century Masters - The Millennium Collection: The Best of Scorpions', 4.95), (271, 'Revelations', 4.95), (254, 'Aquaman', 3.98), (9, 'Plays Metallica By Four Cellos', 3.96), (13, 'The Best Of Billy Cobham', 3.96), (31, 'Bongo Fury', 3.96), (43, 'MK III The Final Concerts [Disc 1]', 3.96), (49, 'The Essential Miles Davis [Disc 2]', 3.96), (60, 'Fireball', 3.96), (62, 'Machine Head', 3.96), (64, 'Slaves And Masters', 3.96), (65, 'Stormbringer', 3.96), (68, 'Outbreak', 3.96), (100, 'Iron Maiden', 3.96), (103, 'Live At Donington 1992 (Disc 1)', 3.96), (121, 'Surfing with the Alien (Remastered)', 3.96), (181, 'Ten', 3.96), (183, 'Dark Side Of The Moon', 3.96), (200, 'O Samba Poconé', 3.96), (214, 'The Doors', 3.96), (269, 'Temple of the Dog', 3.96), (270, 'Carry On', 3.96), (3, 'Restless and Wild', 2.9699999999999998), (15, 'Alcohol Fueled Brewtality Live! [Disc 2]', 2.9699999999999998), (59, 'Deep Purple In Rock', 2.9699999999999998), (137, 'The Song Remains The Same (Disc 1)', 2.9699999999999998), (173, 'No More Tears (Remastered)', 2.9699999999999998), (197, 'Santana - As Years Go By', 2.9699999999999998), (198, 'Santana Live', 2.9699999999999998), (2, 'Balls to the Wall', 1.98), (16, 'Black Sabbath', 1.98), (22, 'Sozinho Remix Ao Vivo', 1.98), (44, 'Physical Graffiti [Disc 1]', 1.98), (87, 'Quanta Gente Veio ver--Bônus De Carnaval', 1.98), (138, 'The Song Remains The Same (Disc 2)', 1.98), (172, 'Diary of a Madman (Remastered)', 1.98), (299, 'Scheherazade', 1.98), (312, 'Berlioz: Symphonie Fantastique', 1.98), (327, 'Bach: Orchestral Suites Nos. 1 - 4', 1.98), (333, 'Purcell: Music for the Queen Mary', 1.98), (344, "Schubert: The Late String Quartets & String Quintet (3 CD's)", 1.98), (50, 'The Final Concerts (Disc 2)', 0.99), (170, 'Bark at the Moon (Remastered)', 0.99), (171, 'Blizzard of Ozz', 0.99), (252, 'Un-Led-Ed', 0.99), (263, 'Muso Ko', 0.99), (265, 'Every Kind of Light', 0.99), (266, 'Duos II', 0.99), (274, 'Pachelbel: Canon & Gigue', 0.99), (278, 'Bach: The Cello Suites', 0.99), (279, 'Handel: The Messiah (Highlights)', 0.99), (280, 'The World of Classical Favourites', 0.99), (283, 'Haydn: Symphonies 99 - 104', 0.99), (287, 'Wagner: Favourite Overtures', 0.99), (288, 'Fauré: Requiem, Ravel: Pavane & Others', 0.99), (292, 'Holst: The Planets, Op. 32 & Vaughan Williams: Fantasies', 0.99), (300, 'Bach: The Brandenburg Concertos', 0.99), (301, 'Chopin: Piano Concertos Nos. 1 & 2', 0.99), (303, 'Sibelius: Finlandia', 0.99), (304, 'Beethoven Piano Sonatas: Moonlight & Pastorale', 0.99), (306, 'Elgar: Cello Concerto & Vaughan Williams: Fantasias', 0.99), (307, 'Adams, John: The Chairman Dances', 0.99), (308, "Tchaikovsky: 1812 Festival Overture, Op.49, Capriccio Italien & Beethoven: Wellington's Victory", 0.99), (310, 'Prokofiev: Romeo & Juliet', 0.99), (314, 'English Renaissance', 0.99), (316, 'Grieg: Peer Gynt Suites & Sibelius: Pelléas et Mélisande', 0.99), (320, 'Mozart: Symphonies Nos. 40 & 41', 0.99), (323, 'Carried to Dust (Bonus Track Version)', 0.99), (324, "Beethoven: Symphony No. 6 'Pastoral' Etc.", 0.99), (325, 'Bartok: Violin & Viola Concertos', 0.99), (326, "Mendelssohn: A Midsummer Night's Dream", 0.99), (329, 'South American Getaway', 0.99), (330, 'Górecki: Symphony No. 3', 0.99), (331, 'Purcell: The Fairy Queen', 0.99), (334, 'Weill: The Seven Deadly Sins', 0.99), (335, 'J.S. Bach: Chaconne, Suite in E Minor, Partita in E Major & Prelude, Fugue and Allegro', 0.99), (337, 'Szymanowski: Piano Works, Vol. 1', 0.99), (338, 'Nielsen: The Six Symphonies', 0.99), (340, "Liszt - 12 Études D'Execution Transcendante", 0.99), (343, 'Respighi:Pines of Rome', 0.99)]
Question: What are the top 10 most popular tracks?

Response: SELECT tracks.Name, COUNT(playlist_track.TrackId) AS Popularity
FROM tracks
JOIN playlist_track ON tracks.TrackId = playlist_track.TrackId
GROUP BY tracks.TrackId
ORDER BY Popularity DESC
LIMIT 10 

Database Query Result: [('Intoitus: Adorate Deum', 5), ('Miserere mei, Deus', 5), ('Aria Mit 30 Veränderungen, BWV 988 "Goldberg Variations": Aria', 5), ('Suite for Solo Cello No. 1 in G Major, BWV 1007: I. Prélude', 5), ('The Messiah: Behold, I Tell You a Mystery... The Trumpet Shall Sound', 5), ('Solomon HWV 67: The Arrival of the Queen of Sheba', 5), ('Symphony No.5 in C Minor: I. Allegro con brio', 5), ('Ave Maria', 5), ('Nabucco: Chorus, "Va, Pensiero, Sull\'ali Dorate"', 5), ('Die Walküre: The Ride of the Valkyries', 5)]
Question: Who is the employee who serviced the most number of customer transactions?

Response: SELECT employees.FirstName, employees.LastName, COUNT(customers.SupportRepId) AS Transactions
FROM employees
JOIN customers ON employees.EmployeeId = customers.SupportRepId
GROUP BY customers.SupportRepId
ORDER BY Transactions DESC
LIMIT 1 

Question: Which employees have sold the most in dollars? Give me the top 10

Response: SELECT e.EmployeeId, e.FirstName, e.LastName, SUM(i.Total) AS TotalSales
FROM employees e
JOIN customers c ON e.EmployeeId = c.SupportRepId
JOIN invoices i ON c.CustomerId = i.CustomerId
GROUP BY e.EmployeeId, e.FirstName, e.LastName
ORDER BY TotalSales DESC
LIMIT 10 

Database Query Result: [('Jane', 'Peacock', 21)]
Database Query Result: [(3, 'Jane', 'Peacock', 833.04), (4, 'Margaret', 'Park', 775.4), (5, 'Steve', 'Johnson', 720.16)]
Question: What is the most popular genre of music bought by customers?

Response: SELECT genres.Name, COUNT(*) AS GenreCount
FROM genres
JOIN tracks ON genres.GenreId = tracks.GenreId
JOIN invoice_items ON tracks.TrackId = invoice_items.TrackId
GROUP BY genres.Name
ORDER BY GenreCount DESC
LIMIT 1 

Database Query Result: [('Rock', 835)]
Question: What is the average price of a track bought by the customer who spent the most money?

Response: SELECT AVG(tracks.UnitPrice) AS AveragePrice
FROM tracks
JOIN invoice_items ON tracks.TrackId = invoice_items.TrackId
JOIN invoices ON invoice_items.InvoiceId = invoices.InvoiceId
WHERE invoices.CustomerId = (
    SELECT invoices.CustomerId
    FROM invoices
    GROUP BY invoices.CustomerId
    ORDER BY SUM(invoices.Total) DESC
    LIMIT 1
) 

Database Query Result: [(1.3057894736842104,)]
Question: Give me the names of the top 10 customers who spent the most on tracks in this database.

Response: SELECT c.FirstName || ' ' || c.LastName AS CustomerName
FROM customers c
JOIN invoices i ON c.CustomerId = i.CustomerId
JOIN invoice_items ii ON i.InvoiceId = ii.InvoiceId
GROUP BY c.CustomerId
ORDER BY SUM(ii.UnitPrice * ii.Quantity) DESC
LIMIT 10 

Database Query Result: [('Helena Holý',), ('Richard Cunningham',), ('Luis Rojas',), ('Ladislav Kovács',), ("Hugh O'Reilly",), ('Frank Ralston',), ('Julia Barnett',), ('Fynn Zimmermann',), ('Astrid Gruber',), ('Victor Stevens',)]
Question: Which employee’s boss has the most employees reporting to him?

Response: SELECT e.[LastName] AS BossLastName, e.[FirstName] AS BossFirstName, COUNT(subE.EmployeeId) AS NumberOfEmployeesReporting
FROM employees e
JOIN employees subE ON e.EmployeeId = subE.ReportsTo
GROUP BY e.EmployeeId
ORDER BY NumberOfEmployeesReporting DESC
LIMIT 1 

Database Query Result: [('Edwards', 'Nancy', 3)]
Question: Which artist has the most tracks in playlists?

Response: SELECT artists.Name, COUNT(playlist_track.TrackId) AS TrackCount
FROM artists
JOIN albums ON artists.ArtistId = albums.ArtistId
JOIN tracks ON albums.AlbumId = tracks.AlbumId
JOIN playlist_track ON tracks.TrackId = playlist_track.TrackId
GROUP BY artists.Name
ORDER BY TrackCount DESC
LIMIT 1 

Database Query Result: [('Iron Maiden', 516)]
Question: Which artist has the most sales?

Response: SELECT artists.Name, SUM(invoice_items.Quantity) AS TotalSales
FROM artists
JOIN albums ON artists.ArtistId = albums.ArtistId
JOIN tracks ON albums.AlbumId = tracks.AlbumId
JOIN invoice_items ON tracks.TrackId = invoice_items.TrackId
GROUP BY artists.ArtistId
ORDER BY TotalSales DESC
LIMIT 1 

Database Query Result: [('Iron Maiden', 140)]
Question: Who is the boss of the employee who serviced the highest number of customer transactions?

Response: SELECT e.FirstName || ' ' || e.LastName AS BossName
FROM employees e
JOIN employees sub ON sub.ReportsTo = e.EmployeeId
JOIN customers c ON c.SupportRepId = sub.EmployeeId
JOIN invoices i ON i.CustomerId = c.CustomerId
GROUP BY sub.EmployeeId
ORDER BY COUNT(i.InvoiceId) DESC
LIMIT 1 

Database Query Result: [('Nancy Edwards',)]
Question: What is the last track that each customer purchased?

Response: SELECT customers.CustomerId, customers.FirstName, customers.LastName, tracks.TrackId, tracks.Name AS TrackName
FROM customers
JOIN invoices ON customers.CustomerId = invoices.CustomerId
JOIN invoice_items ON invoices.InvoiceId = invoice_items.InvoiceId
JOIN tracks ON invoice_items.TrackId = tracks.TrackId
WHERE invoice_items.InvoiceLineId IN (
    SELECT MAX(invoice_items.InvoiceLineId)
    FROM invoice_items
    JOIN invoices ON invoice_items.InvoiceId = invoices.InvoiceId
    GROUP BY invoices.CustomerId
) 

Database Query Result: [(59, 'Puja', 'Srivastava', 2364, 'Mellowship Slinky In B Major'), (38, 'Niklas', 'Schröder', 2596, 'Tommy Gun'), (2, 'Leonie', 'Köhler', 2736, 'Boris The Spider'), (17, 'Jack', 'Smith', 2828, 'The Passage'), (40, 'Dominique', 'Lefebvre', 2968, 'City Of Blinding Lights'), (55, 'Mark', 'Taylor', 3060, 'Little Guitars'), (19, 'Tim', 'Goyer', 3200, 'Gay Witch Hunt'), (34, 'João', 'Fernandes', 3292, 'Still Loving You'), (57, 'Luis', 'Rojas', 3432, "Scheherazade, Op. 35: I. The Sea and Sindbad's Ship"), (13, 'Fernanda', 'Ramos', 21, "Hell Ain't A Bad Place To Be"), (36, 'Hannah', 'Schneider', 161, 'Snowblind'), (51, 'Joakim', 'Johansson', 253, 'Maracatu Atômico'), (15, 'Jennifer', 'Peterson', 393, 'Tarde Em Itapoã'), (30, 'Edward', 'Francis', 485, 'Minority'), (53, 'Phil', 'Hughes', 625, 'Blue Rythm Fantasy'), (9, 'Kara', 'Nielsen', 717, 'Eu Sou Neguinha (Ao Vivo)'), (32, 'Aaron', 'Mitchell', 857, 'Álibi'), (47, 'Lucas', 'Mancini', 949, 'Get Out'), (11, 'Alexandre', 'Rocha', 1089, 'Is This Love (Live)'), (26, 'Richard', 'Cunningham', 1181, 'Pretty Tied Up'), (49, 'Stanisław', 'Wójcik', 1321, 'Hallowed Be Thy Name'), (5, 'František', 'Wichterlová', 1413, 'Como Estais Amigos'), (14, 'Mark', 'Philips', 1539, 'Equinocio'), (28, 'Julia', 'Barnett', 1553, "You've Got Another Thing Comin'"), (37, 'Fynn', 'Zimmermann', 1591, 'Ozone Baby'), (43, 'Isabelle', 'Mercier', 1645, 'Hats Off To (Roy) Harper'), (52, 'Emma', 'Jones', 1771, 'Segue O Seco'), (7, 'Astrid', 'Gruber', 1785, 'Abraham, Martin And John'), (16, 'Frank', 'Harris', 1823, 'So What'), (22, 'Heather', 'Leacock', 1877, 'Fade To Black'), (31, 'Martha', 'Silk', 2003, 'Smells Like Teen Spirit'), (45, 'Ladislav', 'Kovács', 2017, 'Sangue Latino'), (54, 'Steve', 'Murray', 2055, 'Brasília 5:31'), (1, 'Luís', 'Gonçalves', 2109, 'Paranoid'), (10, 'Eduardo', 'Martins', 2235, 'Any Colour You Like'), (24, 'Frank', 'Ralston', 2249, 'Rappers Reais'), (33, 'Ellie', 'Sullivan', 2287, 'You Are The Everything'), (39, 'Camille', 'Bernard', 2341, 'Bê-a-Bá'), (48, 'Johannes', 'Van der Berg', 2467, 'Os Exilados'), (3, 'François', 'Tremblay', 2481, 'Waiting'), (4, 'Bjørn', 'Hansen', 2483, 'Rock On'), (8, 'Daan', 'Peeters', 2495, 'Bullet With Butterfly Wings'), (12, 'Roberto', 'Almeida', 2519, 'Burden In My Hand'), (18, 'Michelle', 'Brooks', 2573, 'Sting Me'), (27, 'Patrick', 'Gray', 2699, 'Sweethearts Together'), (41, 'Marc', 'Dubois', 2713, 'Release'), (42, 'Wyatt', 'Girard', 2715, 'The River (Remix)'), (46, 'Hugh', "O'Reilly", 2727, 'Babylon'), (50, 'Enrique', 'Muñoz', 2751, 'Primavera'), (56, 'Diego', 'Gutiérrez', 2805, 'Sua Impossivel Chance'), (6, 'Helena', 'Holý', 2931, 'So Cruel'), (20, 'Dan', 'Miller', 2945, 'Peace On Earth'), (21, 'Kathy', 'Chase', 2947, 'New York'), (23, 'John', 'Gordon', 2951, 'Sweetest Thing'), (25, 'Victor', 'Stevens', 2959, 'Hallelujah Here She Comes'), (29, 'Robert', 'Brown', 2983, 'The Playboy Mansion'), (35, 'Madalena', 'Sampaio', 3037, 'The Wanderer'), (44, 'Terhi', 'Hämäläinen', 3163, 'Samba pras moças'), (58, 'Manoj', 'Pareek', 3177, 'Hot Girl')]
Question: Name the most popular genre by state in the US present in the database

Response: SELECT g.Name, i.BillingState, COUNT(i.InvoiceId) AS Sales
FROM genres g
JOIN tracks t ON g.GenreId = t.GenreId
JOIN invoice_items ii ON t.TrackId = ii.TrackId
JOIN invoices i ON ii.InvoiceId = i.InvoiceId
WHERE i.BillingCountry = 'USA'
GROUP BY g.Name, i.BillingState
ORDER BY i.BillingState, Sales DESC 

Database Query Result: [('Rock', 'AZ', 16), ('Latin', 'AZ', 6), ('Metal', 'AZ', 5), ('Classical', 'AZ', 4), ('Alternative & Punk', 'AZ', 2), ('Pop', 'AZ', 2), ('Blues', 'AZ', 1), ('Heavy Metal', 'AZ', 1), ('Hip Hop/Rap', 'AZ', 1), ('Rock', 'CA', 36), ('Latin', 'CA', 24), ('Metal', 'CA', 17), ('Alternative & Punk', 'CA', 8), ('Jazz', 'CA', 8), ('Blues', 'CA', 6), ('Bossa Nova', 'CA', 5), ('Heavy Metal', 'CA', 3), ('TV Shows', 'CA', 3), ('R&B/Soul', 'CA', 2), ('Reggae', 'CA', 2), ('Metal', 'FL', 12), ('Rock', 'FL', 7), ('Alternative & Punk', 'FL', 6), ('Latin', 'FL', 5), ('Jazz', 'FL', 3), ('Rock And Roll', 'FL', 2), ('TV Shows', 'FL', 2), ('Blues', 'FL', 1), ('Rock', 'IL', 12), ('Alternative', 'IL', 5), ('Comedy', 'IL', 5), ('Latin', 'IL', 5), ('Classical', 'IL', 4), ('Metal', 'IL', 2), ('R&B/Soul', 'IL', 2), ('Alternative & Punk', 'IL', 1), ('Hip Hop/Rap', 'IL', 1), ('TV Shows', 'IL', 1), ('Latin', 'MA', 12), ('Metal', 'MA', 7), ('Alternative & Punk', 'MA', 5), ('Rock', 'MA', 5), ('Jazz', 'MA', 3), ('Pop', 'MA', 2), ('R&B/Soul', 'MA', 2), ('Blues', 'MA', 1), ('Rock And Roll', 'MA', 1), ('Rock', 'NV', 9), ('Latin', 'NV', 7), ('Metal', 'NV', 5), ('Alternative & Punk', 'NV', 4), ('Reggae', 'NV', 4), ('Jazz', 'NV', 3), ('Soundtrack', 'NV', 3), ('R&B/Soul', 'NV', 2), ('Pop', 'NV', 1), ('Rock', 'NY', 19), ('Latin', 'NY', 7), ('Blues', 'NY', 6), ('Jazz', 'NY', 3), ('Metal', 'NY', 2), ('R&B/Soul', 'NY', 1), ('Rock', 'TX', 14), ('Latin', 'TX', 7), ('Drama', 'TX', 6), ('Alternative & Punk', 'TX', 5), ('TV Shows', 'TX', 3), ('Metal', 'TX', 2), ('Sci Fi & Fantasy', 'TX', 1), ('Rock', 'UT', 17), ('Alternative & Punk', 'UT', 8), ('Latin', 'UT', 4), ('Sci Fi & Fantasy', 'UT', 4), ('Metal', 'UT', 3), ('Comedy', 'UT', 2), ('Rock', 'WA', 8), ('Alternative & Punk', 'WA', 7), ('Latin', 'WA', 7), ('Metal', 'WA', 6), ('Easy Listening', 'WA', 3), ('Bossa Nova', 'WA', 2), ('Jazz', 'WA', 2), ('Science Fiction', 'WA', 1), ('Soundtrack', 'WA', 1), ('TV Shows', 'WA', 1), ('Rock', 'WI', 14), ('Latin', 'WI', 7), ('Alternative & Punk', 'WI', 4), ('TV Shows', 'WI', 4), ('Metal', 'WI', 3), ('R&B/Soul', 'WI', 3), ('Hip Hop/Rap', 'WI', 2), ('Comedy', 'WI', 1)]
Question: What album was the most popular among customers?

Response: SELECT albums.Title 
FROM albums 
JOIN tracks ON albums.AlbumId = tracks.AlbumId 
JOIN invoice_items ON tracks.TrackId = invoice_items.TrackId 
GROUP BY albums.AlbumId 
ORDER BY COUNT(invoice_items.InvoiceLineId) DESC 
LIMIT 1 

Database Query Result: [('Minha Historia',)]
Question: What is each customer’s favorite genre of music?

Response: SELECT 
    c.CustomerId,
    c.FirstName,
    c.LastName,
    g.Name AS FavoriteGenre
FROM customers c
JOIN invoices i ON c.CustomerId = i.CustomerId
JOIN invoice_items ii ON i.InvoiceId = ii.InvoiceId
JOIN tracks t ON ii.TrackId = t.TrackId
JOIN genres g ON t.GenreId = g.GenreId
GROUP BY c.CustomerId, c.FirstName, c.LastName, g.Name
ORDER BY COUNT(ii.InvoiceLineId) DESC
LIMIT 1 OVER(PARTITION BY c.CustomerId) 

Question: What genres are most popular in each country?

Response: SELECT  
    g.Name AS Genre,  
    bi.BillingCountry AS Country,  
    COUNT(ii.InvoiceLineId) AS TotalSales  
FROM invoice_items ii  
JOIN tracks t ON ii.TrackId = t.TrackId  
JOIN genres g ON t.GenreId = g.GenreId  
JOIN invoices i ON ii.InvoiceId = i.InvoiceId  
JOIN (  
    SELECT  
        i.InvoiceId,  
        i.BillingCountry  
    FROM invoices i  
) bi ON i.InvoiceId = bi.InvoiceId  
GROUP BY bi.BillingCountry, g.Name  
ORDER BY bi.BillingCountry, TotalSales DESC   

Database Query Result: [('Rock', 'Argentina', 9), ('Alternative & Punk', 'Argentina', 9), ('Latin', 'Argentina', 8), ('Metal', 'Argentina', 7), ('Jazz', 'Argentina', 2), ('Easy Listening', 'Argentina', 2), ('Soundtrack', 'Argentina', 1), ('Rock', 'Australia', 22), ('Metal', 'Australia', 8), ('Heavy Metal', 'Australia', 3), ('Reggae', 'Australia', 2), ('Latin', 'Australia', 2), ('Blues', 'Australia', 1), ('Rock', 'Austria', 15), ('Metal', 'Austria', 7), ('TV Shows', 'Austria', 4), ('R&B/Soul', 'Austria', 4), ('Latin', 'Austria', 2), ('Jazz', 'Austria', 2), ('Classical', 'Austria', 2), ('Pop', 'Austria', 1), ('Drama', 'Austria', 1), ('Rock', 'Belgium', 21), ('Alternative & Punk', 'Belgium', 14), ('R&B/Soul', 'Belgium', 2), ('Metal', 'Belgium', 1), ('Rock', 'Brazil', 81), ('Latin', 'Brazil', 53), ('Metal', 'Brazil', 15), ('Alternative & Punk', 'Brazil', 7), ('Reggae', 'Brazil', 6), ('Classical', 'Brazil', 6), ('Blues', 'Brazil', 6), ('Soundtrack', 'Brazil', 4), ('R&B/Soul', 'Brazil', 3), ('Pop', 'Brazil', 3), ('World', 'Brazil', 2), ('Sci Fi & Fantasy', 'Brazil', 2), ('Hip Hop/Rap', 'Brazil', 2), ('Rock', 'Canada', 107), ('Latin', 'Canada', 60), ('Metal', 'Canada', 40), ('Alternative & Punk', 'Canada', 36), ('Jazz', 'Canada', 13), ('Reggae', 'Canada', 7), ('Bossa Nova', 'Canada', 7), ('World', 'Canada', 6), ('R&B/Soul', 'Canada', 5), ('Hip Hop/Rap', 'Canada', 5), ('Classical', 'Canada', 5), ('Electronica/Dance', 'Canada', 4), ('Blues', 'Canada', 4), ('Rock And Roll', 'Canada', 2), ('Drama', 'Canada', 2), ('TV Shows', 'Canada', 1), ('Rock', 'Chile', 9), ('Latin', 'Chile', 8), ('Drama', 'Chile', 4), ('Metal', 'Chile', 3), ('Easy Listening', 'Chile', 3), ('TV Shows', 'Chile', 2), ('Science Fiction', 'Chile', 2), ('Blues', 'Chile', 2), ('Alternative & Punk', 'Chile', 2), ('Soundtrack', 'Chile', 1), ('Sci Fi & Fantasy', 'Chile', 1), ('Classical', 'Chile', 1), ('Rock', 'Czech Republic', 25), ('Latin', 'Czech Republic', 9), ('Alternative & Punk', 'Czech Republic', 9), ('TV Shows', 'Czech Republic', 8), ('Metal', 'Czech Republic', 6), ('Drama', 'Czech Republic', 6), ('Pop', 'Czech Republic', 4), ('Jazz', 'Czech Republic', 3), ('R&B/Soul', 'Czech Republic', 2), ('Electronica/Dance', 'Czech Republic', 2), ('Science Fiction', 'Czech Republic', 1), ('Blues', 'Czech Republic', 1), ('Rock', 'Denmark', 21), ('Metal', 'Denmark', 6), ('Latin', 'Denmark', 4), ('Alternative & Punk', 'Denmark', 4), ('Pop', 'Denmark', 3), ('Rock', 'Finland', 18), ('Latin', 'Finland', 9), ('Sci Fi & Fantasy', 'Finland', 4), ('Metal', 'Finland', 2), ('Jazz', 'Finland', 2), ('Alternative & Punk', 'Finland', 2), ('Reggae', 'Finland', 1), ('Rock', 'France', 65), ('Alternative & Punk', 'France', 31), ('Latin', 'France', 26), ('Metal', 'France', 20), ('Jazz', 'France', 11), ('Classical', 'France', 10), ('Soundtrack', 'France', 5), ('Drama', 'France', 4), ('Alternative', 'France', 4), ('Sci Fi & Fantasy', 'France', 2), ('Pop', 'France', 2), ('Hip Hop/Rap', 'France', 2), ('Electronica/Dance', 'France', 2), ('Blues', 'France', 2), ('TV Shows', 'France', 1), ('Rock And Roll', 'France', 1), ('Reggae', 'France', 1), ('Bossa Nova', 'France', 1), ('Rock', 'Germany', 62), ('Metal', 'Germany', 25), ('Latin', 'Germany', 18), ('Blues', 'Germany', 14), ('Alternative & Punk', 'Germany', 13), ('Soundtrack', 'Germany', 5), ('TV Shows', 'Germany', 3), ('Heavy Metal', 'Germany', 3), ('Science Fiction', 'Germany', 2), ('Jazz', 'Germany', 2), ('Easy Listening', 'Germany', 2), ('Pop', 'Germany', 1), ('Drama', 'Germany', 1), ('Alternative', 'Germany', 1), ('Rock', 'Hungary', 11), ('R&B/Soul', 'Hungary', 5), ('Metal', 'Hungary', 5), ('TV Shows', 'Hungary', 4), ('Latin', 'Hungary', 3), ('Alternative & Punk', 'Hungary', 3), ('Drama', 'Hungary', 2), ('Blues', 'Hungary', 2), ('Sci Fi & Fantasy', 'Hungary', 1), ('Electronica/Dance', 'Hungary', 1), ('Comedy', 'Hungary', 1), ('Rock', 'India', 25), ('Alternative & Punk', 'India', 11), ('Jazz', 'India', 10), ('Latin', 'India', 9), ('Metal', 'India', 8), ('R&B/Soul', 'India', 4), ('Blues', 'India', 3), ('Classical', 'India', 2), ('TV Shows', 'India', 1), ('Sci Fi & Fantasy', 'India', 1), ('Rock', 'Ireland', 12), ('TV Shows', 'Ireland', 7), ('Latin', 'Ireland', 7), ('Alternative & Punk', 'Ireland', 4), ('Metal', 'Ireland', 3), ('Jazz', 'Ireland', 3), ('Drama', 'Ireland', 1), ('Blues', 'Ireland', 1), ('Rock', 'Italy', 18), ('Alternative & Punk', 'Italy', 11), ('Blues', 'Italy', 4), ('Latin', 'Italy', 2), ('Classical', 'Italy', 2), ('Metal', 'Italy', 1), ('Rock', 'Netherlands', 18), ('Alternative & Punk', 'Netherlands', 5), ('Blues', 'Netherlands', 4), ('Sci Fi & Fantasy', 'Netherlands', 3), ('Pop', 'Netherlands', 3), ('Latin', 'Netherlands', 3), ('Metal', 'Netherlands', 2), ('Rock', 'Norway', 17), ('Latin', 'Norway', 5), ('Classical', 'Norway', 5), ('Alternative', 'Norway', 4), ('Electronica/Dance', 'Norway', 2), ('Drama', 'Norway', 2), ('Alternative & Punk', 'Norway', 2), ('World', 'Norway', 1), ('Rock', 'Poland', 22), ('Latin', 'Poland', 7), ('Alternative & Punk', 'Poland', 7), ('Jazz', 'Poland', 1), ('Blues', 'Poland', 1), ('Rock', 'Portugal', 31), ('Latin', 'Portugal', 13), ('Metal', 'Portugal', 11), ('Alternative & Punk', 'Portugal', 5), ('Pop', 'Portugal', 4), ('World', 'Portugal', 2), ('R&B/Soul', 'Portugal', 2), ('Jazz', 'Portugal', 2), ('Heavy Metal', 'Portugal', 2), ('TV Shows', 'Portugal', 1), ('Sci Fi & Fantasy', 'Portugal', 1), ('Electronica/Dance', 'Portugal', 1), ('Blues', 'Portugal', 1), ('Rock', 'Spain', 22), ('Latin', 'Spain', 4), ('Alternative & Punk', 'Spain', 4), ('Metal', 'Spain', 3), ('Reggae', 'Spain', 2), ('Jazz', 'Spain', 2), ('Hip Hop/Rap', 'Spain', 1), ('Latin', 'Sweden', 12), ('Rock', 'Sweden', 10), ('Metal', 'Sweden', 7), ('Alternative & Punk', 'Sweden', 6), ('World', 'Sweden', 1), ('TV Shows', 'Sweden', 1), ('Jazz', 'Sweden', 1), ('Rock', 'USA', 157), ('Latin', 'USA', 91), ('Metal', 'USA', 64), ('Alternative & Punk', 'USA', 50), ('Jazz', 'USA', 22), ('Blues', 'USA', 15), ('TV Shows', 'USA', 14), ('R&B/Soul', 'USA', 12), ('Comedy', 'USA', 8), ('Classical', 'USA', 8), ('Bossa Nova', 'USA', 7), ('Reggae', 'USA', 6), ('Drama', 'USA', 6), ('Sci Fi & Fantasy', 'USA', 5), ('Pop', 'USA', 5), ('Alternative', 'USA', 5), ('Soundtrack', 'USA', 4), ('Hip Hop/Rap', 'USA', 4), ('Heavy Metal', 'USA', 4), ('Rock And Roll', 'USA', 3), ('Easy Listening', 'USA', 3), ('Science Fiction', 'USA', 1), ('Rock', 'United Kingdom', 37), ('Latin', 'United Kingdom', 31), ('Metal', 'United Kingdom', 20), ('Alternative & Punk', 'United Kingdom', 9), ('Reggae', 'United Kingdom', 5), ('Jazz', 'United Kingdom', 4), ('Hip Hop/Rap', 'United Kingdom', 3), ('R&B/Soul', 'United Kingdom', 2), ('Pop', 'United Kingdom', 2), ('World', 'United Kingdom', 1)]
